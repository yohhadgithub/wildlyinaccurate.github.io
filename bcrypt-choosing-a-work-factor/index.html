<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width,initial-scale=1"> <title>Bcrypt: Choosing a Work Factor | Wildly Inaccurate</title> <meta name="description" content="Bcrypt is a Blowfish-based hashing algorithm which is commonly used for password hashing because of its potentially expensive key setup phase. A Bcrypt hash has the following structure:$2a$(2 chars work)$(22 chars salt)(31 chars hash)The reason th..."> <link rel="stylesheet" href="/css/main.a3fe98f.css"> <link rel="canonical" href="https://wildlyinaccurate.com/bcrypt-choosing-a-work-factor"> <link rel="alternate" type="application/atom+xml" title="Wildly Inaccurate" href="https://wildlyinaccurate.com/feed.xml"> </head> <body> <nav class="navbar"> <div class="container"> <a href="https://wildlyinaccurate.com" class="navbar__title navbar__link">Wildly Inaccurate</a> <ul class="navbar-nav"> <li class="navbar-nav__item"> <a class="navbar-nav__item-link navbar__link" href="/about/">About</a> </li> <li class="navbar-nav__item"> <a class="navbar-nav__item-link navbar__link" href="/projects/">Projects</a> </li> <li class="navbar-nav__item"> <a class="navbar-nav__item-link navbar__link" href="/search/">Search</a> </li> </ul> </div> </nav> <header class="page-header page-header--no-meta"> <img class="page-header__featured-image" src="/assets/default-featured-image.jpg" srcset="/assets/resized/default-featured-image-320x134.jpg 320w, /assets/resized/default-featured-image-360x150.jpg 360w, /assets/resized/default-featured-image-720x301.jpg 720w, /assets/resized/default-featured-image-940x393.jpg 940w, /assets/resized/default-featured-image-1140x476.jpg 1140w, /assets/resized/default-featured-image-1280x535.jpg 1280w, /assets/resized/default-featured-image-1360x568.jpg 1360w, /assets/resized/default-featured-image-1680x702.jpg 1680w, /assets/resized/default-featured-image-1840x769.jpg 1840w,  /assets/default-featured-image.jpg 2600w"> <div class="container"> <h1 class="page-header__title">Bcrypt: Choosing a Work Factor</h1> <p class="post-meta--header"> Jun 30, 2012 • by Joseph Wynn • posted in <span class="post-meta__data"> [<a href="/category/Security/">Security</a>, <a href="/category/Web Development/">Web Development</a>] </span> </p> </div> </header> <article class="post-content"> <p>Bcrypt is a Blowfish-based hashing algorithm which is commonly used for password hashing because of its potentially expensive key setup phase. A Bcrypt hash has the following structure:</p> <div class="highlighter-rouge"><pre class="highlight"><code>$2a$(2 chars work)$(22 chars salt)(31 chars hash)
</code></pre> </div> <p>The reason that the key setup phase can be potentially expensive is because it is run <code>2<sup>work</sup></code> times. As password hashing is usually associated with common tasks like logging a user into a system, it’s important to find the right balance between security and performance. Using a high work factor makes it incredibly difficult to execute a brute-force attack, but can put unnecessary load on the system.</p> <p>Using <a href="https://gist.github.com/1053158/">Marco Arment’s PHP Bcrypt class</a>, I performed some benchmarks to determine how long it takes to hash a string with various work factors:<!--more--></p> <h3 id="benchmarks">Benchmarks</h3> <p><strong>Desktop Machine, Intel i3-2120 (Quad Core, 3.30GHz)</strong></p> <div class="highlighter-rouge"><pre class="highlight"><code>Work	Time (Seconds)
4	0.0013326406478882
5	0.0024385929107666
6	0.0046159029006958
7	0.0089994072914124
8	0.018425142765045
9	0.035568559169769
10	0.070761203765869
11	0.14275025129318
12	0.28672399520874
13	0.56773639917374
14	1.1397068500519
15	2.2705371022224
16	4.5342264413834
17	9.0786491513252
18	18.10820235014
19	36.225910997391
20	72.565172195435
</code></pre> </div> <p><strong>Linode Xen Instance (Shared Intel Xeon)</strong></p> <div class="highlighter-rouge"><pre class="highlight"><code>Work	Time (Seconds)
4	0.0054517030715942
5	0.0034224390983582
6	0.0065383553504944
7	0.012924599647522
8	0.025654697418213
9	0.050982797145844
10	0.10348515510559
11	0.24127880334854
12	0.5001261472702
13	0.96253979206085
14	1.8935391068459
15	3.821101295948
16	7.3601801991463
17	14.522540104389
18	30.156531906128
19	58.399033403397
20	117.1653290987
</code></pre> </div> <p>Marco’s default work factor of 8 looks like a good place to start, taking 0.2 seconds on both the desktop and Xen instance. Personally I use a work factor of 12, which is fast enough to not be noticed and will (hopefully) still be strong in a few years. With a work factor of 14 you can start to see what kind of difference computational power makes - the desktop machine generates the hash nearly twice as fast as the Xen instance.</p> <p>I don’t believe that there is a “correct” work factor; it depends on how strong you want your hashes to be and how much computational power you want to reserve for the hashing process. Keep in mind that as time goes by and you want to increase your hash strength, you can easily increase the work factor and re-hash each user’s password on their next successful login. This also applies if the password hashing procedure is generating too much load; you can reduce the work factor.</p> </article> <footer class="post-meta post-meta--footer"> <p> This post was written by <strong>Joseph Wynn</strong> on <strong>30 June, 2012</strong>, and last updated on <strong>15 January, 2015</strong>. It was posted in <span class="post-meta__data"> [<a href="/category/Security/">Security</a>, <a href="/category/Web Development/">Web Development</a>] </span> and tagged with <span class="post-meta__data"> [<a href="/tag/bcrypt/">bcrypt</a>, <a href="/tag/brute-force/">brute-force</a>, <a href="/tag/hashing/">hashing</a>] </span> </p> </footer> <div class="post-comments" id="disqus_thread"></div> <script>var disqus_shortname = 'wildlyinaccurate';
    var disqus_url = 'https://wildlyinaccurate.com/bcrypt-choosing-a-work-factor';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();</script> <footer class="page-footer"> <ul class="social-media"> <li> <a href="https://github.com/wildlyinaccurate"> <span class="social-media__icon"> <svg viewBox="0 0 16 16"> <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/> </svg> </span> <span class="username">wildlyinaccurate</span> </a> </li> <li> <a href="https://twitter.com/Joseph_Wynn"> <span class="social-media__icon"> <svg viewBox="0 0 16 16"> <path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                        c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/> </svg> </span> <span class="username">Joseph_Wynn</span> </a> </li> </ul> <p class="site-description site-description--footer">A collection of guides &amp; opinions about programming and the state of the web, from a developer at BBC News. </p> </footer> <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-20744182-3', 'auto');
          ga('send', 'pageview');</script> <script>(function() {
                var s, p, n, a;

                s = document.createElement('script');
                s.async = 1;
                s.src = '//cdn.carbonads.com/carbon.js?zoneid=1673&serve=C6AILKT&placement=wildlyinaccuratecom';
                s.id = '_carbonads_js';

                p = document.createElement('p');
                p.appendChild(s);

                n = document.querySelector('.post-content > p:nth-of-type(3)');

                if (n) {
                    n.parentNode.insertBefore(p, n.nextSibling);
                } else {
                    n = document.getElementsByTagName('article')[0];
                    n.parentNode.insertBefore(p, n.nextSibling);
                }
            })();</script> </body> </html>