<!DOCTYPE html>
<html lang="en">

    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width initial-scale=1">

    <title>eAccelerator and Doctrine 2 | Wildly Inaccurate</title>
    <meta name="description" content="A word of warning: eAccelerator does not play well with Doctrine 2. This came to my attention today after I installed eAccelerator so that I could measure th...">

    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Roboto:400,700|Merriweather:300italic,300,700">
    <link rel="canonical" href="https://wildlyinaccurate.github.io/eaccelerator-and-doctrine-2">
    <link rel="alternate" type="application/atom+xml" title="Wildly Inaccurate" href="https://wildlyinaccurate.github.io/feed.xml">
</head>


    <body>

        <nav class="navbar">
    <div class="container">
        <a href="https://wildlyinaccurate.github.io" class="navbar__title navbar__link">Wildly Inaccurate</a>

        <ul class="navbar-nav">
        
            
            <li class="navbar-nav__item">
                <a class="navbar-nav__item-link navbar__link" href="/about/">About</a>
            </li>
            
        
            
        
            
        
            
        
            
            <li class="navbar-nav__item">
                <a class="navbar-nav__item-link navbar__link" href="/projects/">Projects</a>
            </li>
            
        
            
        
            
        
            
        
        </ul>
    </div>
</nav>


        <header class="page-header">
    
        
    

    <img class="page-header__featured-image" src="/assets/default-featured-image.jpg" srcset="/assets/resized/default-featured-image-290x121.jpg 290w, /assets/resized/default-featured-image-315x132.jpg 315w, /assets/resized/default-featured-image-720x301.jpg 720w, /assets/resized/default-featured-image-940x393.jpg 940w, /assets/resized/default-featured-image-1140x476.jpg 1140w, /assets/resized/default-featured-image-1280x535.jpg 1280w, /assets/resized/default-featured-image-1360x568.jpg 1360w, /assets/resized/default-featured-image-1680x702.jpg 1680w, /assets/resized/default-featured-image-1840x769.jpg 1840w,  /assets/default-featured-image.jpg 2600w">


    <div class="container">
        <h1 class="page-header__title">eAccelerator and Doctrine 2</h1>
        <p class="page-header__meta">
            Nov 13, 2010

            
                • by Joseph Wynn
            

            
        </p>
    </div>
</header>

<article class="post-content">
    <p>A word of warning: eAccelerator does not play well with Doctrine 2. This came to my attention today after I installed eAccelerator so that I could measure the performance gains (if any). As it turns out, one of eAccelerator’s “features” is to remove Docblocks from PHP scripts - probably to reduce compile times. Suddenly my application was throwing exceptions with the message “Class <em>X</em> is not a valid entity or mapped super class”.</p>

<!--more-->

<p>There are ways to configure eAccelerator to ignore Docblocks when “optimising” your code (see <a href="http://eaccelerator.net/ticket/229">this bug report</a>), but I think it is absurd that eAccelerator makes it so difficult to use Docblocks – beberlei from the Doctrine team summed the issue up pretty well:</p>

<blockquote>
  <p><em>“I think it is a very bad style to remove the docblocks from the opcode. The performance gain is probably unmeasurable, however it will severly break applications that rely on the Docblocks (a language feature!! removed). Currently opensource projects using Docblocks are getting more and more:</em></p>

  <ul>
    <li><em>Doctrine 2</em></li>
    <li><em>Zend Framework</em></li>
    <li><em>Symfony 2</em></li>
    <li><em>Flow3</em></li>
    <li><em>PHPUnit</em></li>
    <li><em>and many more…</em></li>
  </ul>

  <p><em>This premature optimization to remove the docblocks should be reverted. Docblocks are a PHP Token for a reason, they are part of the language and should be used that way. Please revise your stand on this otherwise projects must suggest NOT to use eAccelerator by default.”</em></p>
</blockquote>

<p>The bottom line is this: if you are mapping your Doctrine 2 entities using Docblock annotations; you will save yourself a lot of time and stress by <strong>not using eAccelerator</strong>.</p>

<p>Handy tip: to see if eAccelerator is loaded in your PHP installation, call <code>print_r(get_loaded_extensions());</code> and see if eAccelerator is in the array. To disable eAccelerator, open your php.ini file and find <code>zend_extension = "/path/to/extensions/php_eaccelerator.dll"</code>. Put a semicolon (;) in front of it to comment it out, and restart your web server.</p>

</article>


        <footer class="page-footer">

    <ul class="social-media">
        
        <li>
            <a href="https://github.com/wildlyinaccurate">
                <span class="social-media__icon">
                    <svg viewBox="0 0 16 16">
                        <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
                    </svg>
                </span>
                <span class="username">wildlyinaccurate</span>
            </a>
        </li>
        

        
        <li>
            <a href="https://twitter.com/Joseph_Wynn">
                <span class="social-media__icon">
                    <svg viewBox="0 0 16 16">
                        <path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                        c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
                    </svg>
                </span>

                <span class="username">Joseph_Wynn</span>
            </a>
        </li>
        
    </ul>

    <p class="site-description site-description--footer">A collection of guides &amp; opinions about programming and the state of the web, from a developer at BBC News.
</p>

</footer>


        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-20744182-3', 'auto');
          ga('send', 'pageview');
        </script>

        <script>
            (function() {
                var s, p, n, a;

                s = document.createElement('script');
                s.async = 1;
                s.src = '//cdn.carbonads.com/carbon.js?zoneid=1673&serve=C6AILKT&placement=wildlyinaccuratecom';
                s.id = '_carbonads_js';

                p = document.createElement('p');
                p.appendChild(s);

                n = document.querySelector('.post-content > p:nth-of-type(3)');

                if (n) {
                    n.parentNode.insertBefore(p, n.nextSibling);
                } else {
                    n = document.getElementsByTagName('article')[0];
                    n.parentNode.insertBefore(p, n.nextSibling);
                }
            })();
        </script>

    </body>

</html>
