<!DOCTYPE html>
<html lang="en">

    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width initial-scale=1">

    <title>Useful Doctrine 2 Console Commands | Wildly Inaccurate</title>
    <meta name="description" content="Doctrine 2’s console is really powerful when you know how to use it. You can generate entity classes and their method stubs, reverse-engineer a database, val...">

    <link rel="stylesheet" href="/css/main.css">
    <link rel="canonical" href="https://wildlyinaccurate.github.io/useful-doctrine-2-console-commands">
    <link rel="alternate" type="application/atom+xml" title="Wildly Inaccurate" href="https://wildlyinaccurate.github.io/feed.xml">
</head>


    <body>

        <nav class="navbar">
    <div class="container">
        <a href="https://wildlyinaccurate.github.io" class="navbar__title navbar__link">Wildly Inaccurate</a>

        <ul class="navbar-nav">
        
            
            <li class="navbar-nav__item">
                <a class="navbar-nav__item-link navbar__link" href="/about/">About</a>
            </li>
            
        
            
        
            
        
            
        
            
            <li class="navbar-nav__item">
                <a class="navbar-nav__item-link navbar__link" href="/projects/">Projects</a>
            </li>
            
        
            
        
            
        
            
        
        </ul>
    </div>
</nav>


        <header class="page-header">
    
        
    

    <img class="page-header__featured-image" src="/assets/default-featured-image.jpg" srcset="/assets/resized/default-featured-image-290x121.jpg 290w, /assets/resized/default-featured-image-315x132.jpg 315w, /assets/resized/default-featured-image-720x301.jpg 720w, /assets/resized/default-featured-image-940x393.jpg 940w, /assets/resized/default-featured-image-1140x476.jpg 1140w, /assets/resized/default-featured-image-1280x535.jpg 1280w, /assets/resized/default-featured-image-1360x568.jpg 1360w, /assets/resized/default-featured-image-1680x702.jpg 1680w, /assets/resized/default-featured-image-1840x769.jpg 1840w,  /assets/default-featured-image.jpg 2600w">


    <div class="container">
        <h1 class="page-header__title">Useful Doctrine 2 Console Commands</h1>
        <p class="page-header__meta">
            Jan 8, 2011

            
                • by Joseph Wynn
            

            
        </p>
    </div>
</header>

<article class="post-content">
    <p>Doctrine 2’s console is really powerful when you know how to use it. You can generate entity classes and their method stubs, reverse-engineer a database, validate your entity schemas, and much more. In this post, I’m going to cover some of the Doctrine console’s more useful commands and explain how you can use them to reduce development time. For a full overview of the Doctrine 2 console, read the <a href="http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/tools.html">Doctrine Tools</a> documentation.<!--more--></p>

<h2 id="ormvalidate-schema">orm:validate-schema</h2>

<p>Validate that your mapping files are correct and that your database is in sync. Not only does it ensure that your database is up-to-date, it finds errors in your mapping files, detects invalid entity relationships, and even warns you when your naming conventions are inconsistent.</p>

<p>Usage: <code>orm:validate-schema</code></p>

<p>Example output:</p>

<div class="highlight"><pre><code>[Mapping]  FAIL - The entity-class 'modelsAlbum' mapping is invalid:
* The mappings modelsAlbum#tracks and modelsSong#album are incosistent with each other.

[Mapping]  FAIL - The entity-class 'modelsGenre' mapping is invalid:
* The field modelsGenre#related_genres is on the owning side of a bi-directional relationship, but the specified mappedBy association on the target-entity modelsGenre#
does not contain the required 'inversedBy' attribute.

[Mapping]  FAIL - The entity-class 'modelsSong' mapping is invalid:
* The association modelsSong#album refers to the inverse side field modelsAlbum#songs which does not exist.

[Mapping]  FAIL - The entity-class 'modelsSongFile' mapping is invalid:
* The association modelsSongFile#downloads is ordered by a foreign field COUNT(id) that is not a field on the target entity modelsDownload

[Database] FAIL - The database schema is not in sync with the current mapping file.
</code></pre></div>

<h2 id="ormconvert-d1-schema">orm:convert-d1-schema</h2>

<p>Convert a Doctrine 1 schema to Doctrine 2 format. This command can save you a lot of time and headaches when migrating projects from Doctrine 1 to Doctrine 2. The conversions I’ve tested are really accurate, but it would pay to check that everything looks okay after doing a conversion.</p>

<p>Usage: <code>orm:convert-d1-schema from-path to-type dest-path</code></p>

<p>Example: <code>orm:convert-d1-schema models/d1-models annotation models</code></p>

<p>In the above example, all of my Doctrine 1 schema files contained in <code>./models/d1-models</code> will be converted to Doctrine 2 annotation format and saved in <code>./models</code>. The original D1 schemas will not be modified.</p>

<h2 id="ormconvert-mapping">orm:convert-mapping</h2>

<p>Convert your mapping information between different formats. There probably aren’t many situations where you would need to convert your mapping information to a different format, but the feature that makes this command really useful is the <code>--from-database</code> flag. Using the <code>--from-database</code> flag allows you to essentially reverse-engineer a database by creating the mapping information from the database schema.</p>

<p>Usage: <code>orm:convert-mapping to-type dest-path</code></p>

<p>Example: <code>orm:convert-mapping --from-database annotation models/generated</code></p>

<p>The above example will read my database schema and create the entities with annotation mapping in my <code>./models/generated</code> directory. Omitting the <code>--from-database</code> flag would cause the command to read my existing mapping information and convert it to annotation format in the <code>./models/generated</code> directory.</p>

<h2 id="ormgenerate-entities">orm:generate-entities</h2>

<p>Generate entity classes with getter and setter methods from your mapping information. The <code>--regenerate-entities="1"</code> flag will cause your entities to be re-generated even if they exist already. You can also use the <code>--generate-annotations</code> flag to automatically generate annotation metadata on your entities (only useful if your mapping information is not already in annotation format).</p>

<p>For a better idea of what this command can do, run <code>orm:generate-entities --help</code>.</p>

<p>Usage: <code>orm:generate-entities dest-path</code></p>

<p>Example: <code>orm:generate-entities --generate-annotations="true" models/generated</code></p>

<p>This example will read my mapping information and create the entity classes in <code>./models/generated</code>. It will also generate annotation metadata for my entity classes.</p>

</article>


        <footer class="page-footer">

    <ul class="social-media">
        
        <li>
            <a href="https://github.com/wildlyinaccurate">
                <span class="social-media__icon">
                    <svg viewBox="0 0 16 16">
                        <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
                    </svg>
                </span>
                <span class="username">wildlyinaccurate</span>
            </a>
        </li>
        

        
        <li>
            <a href="https://twitter.com/Joseph_Wynn">
                <span class="social-media__icon">
                    <svg viewBox="0 0 16 16">
                        <path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                        c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
                    </svg>
                </span>

                <span class="username">Joseph_Wynn</span>
            </a>
        </li>
        
    </ul>

    <p class="site-description site-description--footer">A collection of guides &amp; opinions about programming and the state of the web, from a developer at BBC News.
</p>

</footer>


        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-20744182-3', 'auto');
          ga('send', 'pageview');
        </script>

        <script>
            (function() {
                var s, p, n, a;

                s = document.createElement('script');
                s.async = 1;
                s.src = '//cdn.carbonads.com/carbon.js?zoneid=1673&serve=C6AILKT&placement=wildlyinaccuratecom';
                s.id = '_carbonads_js';

                p = document.createElement('p');
                p.appendChild(s);

                n = document.querySelector('.post-content > p:nth-of-type(3)');

                if (n) {
                    n.parentNode.insertBefore(p, n.nextSibling);
                } else {
                    n = document.getElementsByTagName('article')[0];
                    n.parentNode.insertBefore(p, n.nextSibling);
                }
            })();
        </script>

    </body>

</html>
